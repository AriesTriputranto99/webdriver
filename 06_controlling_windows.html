<section>
  <h2>Controlling Windows</h2>

  <section>
    <h2>Defining "window" and "frame"</h2>

    <p>Within this specification, a window equates to anything that would be referred to as "window.top" in javascript. Put another way, within this spec browser tabs are counted as separate windows.</p>

    <p><strong>TODO: define "frame"</strong></p>
  </section>

  <section>
    <h2>Window Handles</h2>

    <p>Each window has a "window handle" associated with it. This is an opaque string which MUST uniquely identify the window within the session. This MAY be a UUID. The "getWindowHandle" command can be used to obtain the window handle for the window that commands are currently acting upon:</p>

    <table>
      <tr>
        <td>Command Name</td>
        <td>getWindowHandle</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.</td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>{string} The opaque string which uniquely identifies this window within the session.</td>
      </tr>
    </table>
  </section>

  <section>
    <h2>Iterating Over Windows</h2>

    <table>
      <tr>
        <td>Command Name</td>
        <td>getWindowHandles</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.</td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>{Array.&lt;string&gt;} An array containing a window handle for every open window in this session.</td>
      </tr>
    </table>

    <p>This array of returned strings MUST contain a handle for every window associated with the browser session and no others. In addition, at the time of collecting the window handles the javascript expression "window.top.closed" MUST evaluate to false.</p>

    <p>The ordering of the keys is not defined, but SHOULD be determined by iterating over each top level browser window and returning the tabs within that window before iterating over the tabs of the next top level browser window. For example, in the diagram below, the window handles should be returned as the handles for: win1tab1, win1tab2, win2.</p>

    <img src="example-windows.png" alt="Two top level windows. The first window has two tabs, lablled win1tab1 and win1tab2. The second window has only one tab labelled win2"/>
  </section>

  <section>
    <h2>Closing Windows</h2>

    <table>
      <tr>
        <td>Command Name</td>
        <td>close</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.</td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>None</td>
      </tr>
    </table>

    <p>The close command closes the window that commands are currently being sent to. If this means that a call to get the list of window handles returns an empty list, then this close command MUST be the equivalent of calling "quit". In all other cases, control MUST be returned to the calling process once the window has been closed or an alert is displayed by the closing window.</p>

    <p>Once the window has closed, future commands MUST return an error NoSuchWindowException until a new window is selected for receiving commands.</p>
  </section>

  <section>
    <h2>Resizing and Positioning Windows</h2>

    <table>
      <tr>
        <td>Command Name</td>
        <td>setWindowSize</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.<br />
          "windowHandle" {string} The handle referring to the window to resize.<br/>
          "width" {number} The new window width in pixels.<br />
          "height" {number} The new window height in pixels.
        </td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>None</td>
      </tr>
      <tr>
        <td>Errors</td>
        <td>UnsupportedOperationException if the window could not be resized.</td>
      </tr>

      <tr>
        <td>Command Name</td>
        <td>getWindowSize</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.<br>
          "windowHandle" {string} The handle referring to the window to resize.
        </td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>An object with two keys:<br>
          "width" {number} The width of the specified window in pixels.<br>
          "height" {number} The height of the specified window in pixels.<br>
        </td>
      </tr>

      <tr>
        <td>Command Name</td>
        <td>maximizeWindow</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.<br>
          "windowHandle" {string} The handle referring to the window to resize.
        </td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>None</td>
      </tr>
      <tr>
        <td>Errors</td>
        <td>UnsupportedOperationException if the window could not be resized.</td>
      </tr>

      <tr>
        <td>Command Name</td>
        <td>fullscreenWindow</td>
      </tr>
      <tr>
        <td>Parameters</td>
        <td>"sessionId" {string} The key that identifies which session this request is for.<br>
          "windowHandle" {string} The handle referring to the window to resize.
        </td>
      </tr>
      <tr>
        <td>Return Value</td>
        <td>None</td>
      </tr>
      <tr>
        <td>Errors</td>
        <td>UnsupportedOperationException if the window could not be resized.</td>
      </tr>
    </table>

    <p>Each of these commands accept the window handles returned by "getWindowHandles" and "getWindowHandle". In addition, the window handle may be "current", in which case the window that commands are currently being handled by MUST be acted upon.</p>

    <p>The "width" and "height" values refer to the "window.outerheight" and "window.outerwidth" properties. For those browsers that do not support these properties, these represent the height and width of the whole browser window including window chrome and window resizing borders/handles.</p>

    <p>After setWindowSize, the whole browser window MUST be left as if the restore button had been pressed, and MUST NOT be in the maximised state.</p>

    <p>After maximizeWindow, the whole browser window MUST be left as if the maximise button had been pressed; it is not sufficient to leave the window "restored", but with the full screen dimensions.</p>

    <p>If a request is made to resize a window to a size which cannot be performed (e.g. the browser has a minimum, or fixed window size), an UnsupportedOperationException MUST be thrown.</p>
  </section>

  <section>
    <h2>Scaling the Content of Windows</h2>

    <p>TODO</p>
  </section>

</section>
